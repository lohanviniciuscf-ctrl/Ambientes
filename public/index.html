<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CRM</title>

<style>
:root{
  --bg:#0a192f;
  --card:#112240;
  --accent:#64ffda;
}

body{
  margin:0;
  font-family:Segoe UI, Arial;
  background:var(--bg);
  color:#e6f1ff;
}

.center{
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
}

.card{
  background:var(--card);
  padding:25px;
  border-radius:12px;
  width:320px;
  text-align:center;
}

button,input{
  width:100%;
  padding:10px;
  margin:8px 0;
  border:none;
  border-radius:6px;
}

button{
  background:var(--accent);
  font-weight:bold;
  cursor:pointer;
}

#app{
  display:none;
  padding:20px;
}

header{
  text-align:center;
  font-size:20px;
  margin-bottom:20px;
}

.board{
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:10px;
}

.column{
  background:var(--card);
  padding:10px;
  border-radius:10px;
}

.cardLead{
  background:#020c1b;
  padding:8px;
  margin:6px 0;
  border-radius:6px;
}
</style>
</head>

<body>

<!-- AMBIENTE -->
<div id="envSelect" class="center">
  <div class="card">
    <h3>Escolha o ambiente</h3>
    <button onclick="selectEnv('Modelle Skin')">Modelle Skin</button>
    <button onclick="selectEnv('Cia & Arte')">Cia & Arte</button>
  </div>
</div>

<!-- LOGIN -->
<div id="loginScreen" class="center" style="display:none">
  <div class="card">
    <h3 id="envTitle"></h3>
    <input id="user" placeholder="Usuário">
    <input id="pass" type="password" placeholder="Senha">
    <button onclick="login()">Entrar</button>
    <div id="loginError"></div>
  </div>
</div>

<!-- APP -->
<div id="app">
  <header id="appTitle"></header>

  <input id="nome" placeholder="Cliente">
  <input id="valor" type="number" placeholder="Valor">
  <input id="custo" type="number" placeholder="Custo">
  <button onclick="addLead()">Adicionar Lead</button>

  <div class="board" id="board"></div>
</div>

<script>
const users={
  Lohan:{pass:"D9f0da85",env:["Modelle Skin","Cia & Arte"]},
  marcus:{pass:"Elistray6001",env:["Cia & Arte"]},
  Queila:{pass:"alieuq79",env:["Modelle Skin"]}
};

let currentEnv=null;
let currentUser=null;
const pipeline=["Lead","Em andamento","Proposta","Fechado"];

function selectEnv(env){
  currentEnv=env;
  envSelect.style.display="none";
  loginScreen.style.display="flex";
  envTitle.innerText=env;

  if(env==="Modelle Skin"){
    document.documentElement.style.setProperty("--bg","#f3e0c8");
    document.documentElement.style.setProperty("--card","#e6c9a8");
    document.documentElement.style.setProperty("--accent","#8b5e3c");
  }
}

function login(){
  const u=user.value;
  const p=pass.value;

  if(users[u] && users[u].pass===p && users[u].env.includes(currentEnv)){
    currentUser=u;
    loginScreen.style.display="none";
    app.style.display="block";
    appTitle.innerText=currentEnv+" — "+u;
    load();
  }else{
    loginError.innerText="Login inválido";
  }
}

let leads=[];

function load(){
  leads=JSON.parse(localStorage.getItem(currentEnv+"_"+currentUser))||[];
  render();
}

function save(){
  localStorage.setItem(currentEnv+"_"+currentUser,JSON.stringify(leads));
}

function addLead(){
  leads.push({
    id:Date.now(),
    nome:nome.value,
    valor:+valor.value,
    custo:+custo.value,
    status:pipeline[0]
  });
  save();
  render();
}

function render(){
  board.innerHTML="";
  pipeline.forEach(s=>{
    const col=document.createElement("div");
    col.className="column";
    col.innerHTML="<h4>"+s+"</h4>";
    col.ondragover=e=>e.preventDefault();
    col.ondrop=e=>{
      leads.find(l=>l.id==e.dataTransfer.getData("id")).status=s;
      save();render();
    };

    leads.filter(l=>l.status===s).forEach(l=>{
      const c=document.createElement("div");
      c.className="cardLead";
      c.draggable=true;
      c.ondragstart=e=>e.dataTransfer.setData("id",l.id);
      c.innerHTML=l.nome+"<br>R$ "+l.valor;
      col.appendChild(c);
    });
    board.appendChild(col);
  });
}
</script>

</body>
</html>
